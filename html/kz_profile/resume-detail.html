<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
  <title></title>
  <link href="../../fonts/iconfont.css" rel="stylesheet" />
  <link href="../../css/mui.min.css" rel="stylesheet" />
  <link href="../../css/style.css" rel="stylesheet" />
  <link href="../../css/style-custom.css" rel="stylesheet" />
  <link href="css/profile-style.css" rel="stylesheet" />
  <style>
    .mui-content{
      height: auto;
    }
    .resume-box{
      padding: 10px 0;
    }
    .flow-box a {
      color: #8E78D6;
    }
    .m-title.t2{
      padding: 10px 0;
    }
  </style>
</head>

<body id="main-content">
  <header class="mui-bar mui-bar-nav">
    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
    <h1 class="mui-title">简历详情</h1>
  </header>
  <!--查看的时候才有收藏操作。预览操作无此操作-->
  <!-- ko if: pageType() == 'show' -->
  <nav class="mui-bar mui-bar-tab custom-tab">
    <div class="mui-tab-item">
      <button class="mui-btn mui-btn-blue">收藏</button>
    </div>  
  </nav>
  <!-- /ko -->
  <div class="mui-content">
    <div class="resume-box">
      <div class="flex">
        <div class="resume-img">
          <img
            data-bind="attr: {src: !headurl() ? '../../images/tab-wode/user_default.png' : headurl}"
            src="../../images/tab-wode/user_default.png" />
        </div>
        <div class="flex-1 flex flex-row-center">
          <div class="m-title t1">
            <span data-bind="text: detailData().personname"></span>
            <span class="key-imp">
              <span data-bind="text: detailData().intentpositionText"></span> | 
              <span data-bind="text: detailData().educationText"></span> | 
              <span data-bind="text: detailData().workexperience"></span>
            </span>
          </div>         
        </div>
      </div>
      <div class="mui-row">
        <div class="mui-col-xs-6">
          <div class="tel"><i class="iconfont icon-dianhua"></i><span data-bind="text: detailData().telephone,click: dialTelClick"></span></div>
        </div>
        <div class="mui-col-xs-6">
          <div class="tel"><i class="iconfont icon-youxiang"></i><span data-bind="text: detailData().email"></span></div>
        </div>
      </div>
      <div class="mui-row">
        <div class="mui-col-xs-6">性别：<span data-bind="text: detailData().sexText"></span></div>
        <div class="mui-col-xs-6">出生日期：<span data-bind="text: detailData().birthday"></span></div>
      </div>
      <div class="mui-row">
        <div class="mui-col-xs-6">民族：<span data-bind="text: detailData().ethnic"></span></div>
        <div class="mui-col-xs-6">婚姻状况：<span data-bind="text: detailData().marriageText"></span></div>
      </div>
      <div class="mui-row">
        <div class="mui-col-xs-6">期望职位：<span data-bind="text: detailData().intentpositionText"></span></div>
        <div class="mui-col-xs-6">求职类型：<span data-bind="text: detailData().worknatureText"></span></div>
      </div>
      <div class="mui-row">
        <div class="mui-col-xs-6">期望工资：<span data-bind="text: detailData().wagesText"></span></div>
        <div class="mui-col-xs-6">在职状态：<span data-bind="text: detailData().jobstatusText"></span></div>
      </div>
      <div class="mui-row">期望工作区域：<span data-bind="text: detailData().expectregion"></span></div>
      
      <div class="mui-row">
        <div class="mui-col-xs-6">现住址：<span data-bind="text: detailData().address"></span></div>
      </div>
      <div class="mui-row">参加工作时间：<span data-bind="text: detailData().jointime"></span></div>
    </div>
    <div class="work-edu">
      <div class="m-title t2">资格证书</div>
      <div>
        <!-- ko if: qualificationList().length < 1 -->
        <div class="flow-box">
          <div style="text-align: center;">无数据</div>
        </div>
        <!-- /ko -->
        <!-- ko foreach: qualificationList -->
        <div class="flow-box">
          <div data-bind="text: qualifyname"></div>
          <div><span>获得日期：<span data-bind="text: qualify_time"></span></span><a data-bind="click: $root.previewClick.bind(null, $index())" style="float: right;">点击查看</a></div>
          <div style="display: none;">
            <img data-bind="attr: {src: qualifyurl}" data-preview-src="" data-preview-group="preview" />
          </div>
        </div>
        <!-- /ko -->
      </div>
      <div class="m-title t2">工作经历</div>
      <div>
        <!-- ko if: expList().length < 1 -->
        <div class="flow-box">
          <div style="text-align: center;">无数据</div>
        </div>
        <!-- /ko -->
        <!-- ko foreach: expList -->
        <div class="flow-box">
          <div><span data-bind="text: entrancedate"></span>至<span data-bind="text: dimissiondate"></span></div>
          <div data-bind="text: companyname"></div>
          <!-- ko if: !!positions -->
          <div data-bind="text: positions"></div>
          <!-- /ko -->
        </div>
        <!-- /ko -->
      </div>
      <div class="m-title t2 pt15">教育经历</div>
      <div>
        <!-- ko if: eduList().length < 1 -->
        <div class="flow-box">
          <div style="text-align: center;">无数据</div>
        </div>
        <!-- /ko -->
        <!-- ko foreach: eduList -->
        <div class="flow-box">
          <div><span data-bind="text: entrancedate"></span>至<span data-bind="text: graduatedate"></span></div>
          <div data-bind="text: schoolname"></div>
          <div data-bind="text: profession"></div>
        </div>   
        <!-- /ko -->
      </div>
    </div>
  </div>
  <script src="../../third/bluebird.min.js"></script>
  <script src="../../third/loadash.3.10.1.js"></script>
  <script src="../../js/mui.min.js"></script>
  <script src="../../third/knockout.js"></script>
  <script src="../../third/knockout.extend.js"></script>
  <script src="../../third/ko.mapping.js"></script>
  <script src="../../js/mui.zoom.js"></script>
  <script src="../../js/mui.previewimage.js"></script>
  <script src="../../js/utils.enums.js"></script>
  <script src="../../js/utils.config.js"></script>
  <script src="../../js/utils.storages.js"></script>
  <script src="../../js/utils.auth.js"></script>
  <script src="../../js/utils.upload.js"></script>
  <script src="../../js/utils.request.js" ></script>
  <script src="../../js/utils.common.js" ></script>
  <script src="js/profile-common.js" ></script>
  <script>
    (function($, doc) {
      $.init();
      $.plusReady(function() {
        var muiPreview = $.previewImage();
        var BaseView = function () {
          var vm = this;
          vm.detailData = ko.observable({});
          vm.headurl = ko.observable('');
           // 教育经历
          vm.eduList = ko.observableArray([]);
          // 工作经历
          vm.expList = ko.observableArray([]);
          // 资格证书
          vm.qualificationList = ko.observableArray([]);
          //页面类型  show 查看  preview 预览
          vm.pageType = ko.observable('');
          vm.previewClick = function(index){
            muiPreview.open(index, 'preview');
          }
          
          vm.dialTelClick = function(){
            plus.device.dial(vm.detailData().telephone(), true);
          }
        }
        var viewModel = new BaseView();
        ko.applyBindings(viewModel, doc.getElementById('main-content'));
        // 加载简历详情
        function loadData (id) {
          request.loginAjax('personalresume/viewResumeDetail', {
            showMsg: false,
            data: {
              id: id
            }
          }, function(data,success) {
            if (success) {   
              Enums.getAll(function(){
                 data.wagesText = Enums.getEnumText('salaryRange', data.wages);
                 data.intentpositionText = Enums.getEnumText('positionType', data.intentposition);
                 data.educationText = Enums.getEnumText('education', data.education);
                 data.sexText = data.sex == 1 ? '男' : '女';
                 data.marriageText = data.marriage == 1 ? '未婚' : '已婚';
                 data.worknatureText = data.worknature == 1 ? '全职' : '兼职';
                 data.jobstatusText = data.jobstatus == 1 ? '在职' : '离职';
                 viewModel.headurl(data.headurl);
                 viewModel.eduList(data.eduList);
                 viewModel.expList(data.expList);
                 viewModel.qualificationList(data.qualificationList);
                 viewModel.detailData(ko.mapping.fromJS(data));
              })
            }
          });
        }
        // 收藏
        mui('#main-content').on('tap', '.mui-btn-blue', function(e) {
          request.loginAjax('personalresumeviewlog/collectPersonalResume', {
            data: {
              rid: viewModel.detailData().id()
            }
          }, function(data,success) {
          });
        });
        window.addEventListener('kz_profile_ResumeDetail_Data', function(e) {
          viewModel.pageType(e.detail.type || 'show');
          viewModel.detailData({});
          viewModel.headurl('')
          viewModel.eduList([]);
          viewModel.expList([]);
          viewModel.qualificationList([]);
          loadData(e.detail.id);
        });
      });
    }(mui, document));
  </script>
</body>
</html>