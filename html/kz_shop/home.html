<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
  <title></title>
  <link href="../../fonts/iconfont.css" rel="stylesheet" />
  <link href="../../css/mui.min.css" rel="stylesheet" />
  <link href="../../css/style.css" rel="stylesheet" />
  <link href="../../css/style-custom.css" rel="stylesheet" />
  <link href="css/shop.css" rel="stylesheet" />
</head>

<body>
  <header id="header" class="mui-bar mui-bar-nav">
    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
    <div class="header-search-box">
        <input type="text" placeholder="请输入关键字">
    </div>
  </header>

  <div class="mui-content ">
    <div id="home" class="mui-control-content show">
    	<div class="banner-box">
    		<img src="images/banner.png" alt="" />
    	</div>
    	
    	<div class="menu-list">
    		<h2>特惠</h2>
    		<a href="">查看更多</a>
    	</div>
		<div class="product-list">
			<div class="item product-item">
				<div class="item-box">
					<img src="images/product.png" alt="" />
				</div>
				<div class="name line2">长沙天天 粘接型MBT直丝颊面管0.022″7牙位 上一下一 （新老包装随机发货）</div>
				<div class="price">
					<span>$44.44</span>
					<del>$55.55</del>
				</div>
			</div>
			<div class="item product-item">
				<div class="item-box">
					<img src="images/product.png" alt="" />
				</div>
				<div class="name line2">长沙天天 粘接型MBT直丝颊面管0.022″7牙位 上一下一 （新老包装随机发货）</div>
				<div class="price">
					<span>$44.44</span>
					<del>$55.55</del>
				</div>
			</div>
			<div class="item product-item">
				<div class="item-box">
					<img src="images/product.png" alt="" />
				</div>
				<div class="name line2">长沙天天 粘接型MBT直丝颊面管0.022″7牙位 上一下一 （新老包装随机发货）</div>
				<div class="price">
					<span>$44.44</span>
					<del>$55.55</del>
				</div>
			</div>
			<div class="item product-item">
				<div class="item-box">
					<img src="images/product.png" alt="" />
				</div>
				<div class="name line2">长沙天天 粘接型MBT直丝颊面管0.022″7牙位 上一下一 （新老包装随机发货）</div>
				<div class="price">
					<span>$44.44</span>
					<del>$55.55</del>
				</div>
			</div>

		</div>
		<div class="menu-list">
    		<h2>热门品牌</h2>
    		<a href="">查看更多</a>
    	</div>
    	<div class="brand-list">
    		<div class="item product-item">
    			<img src="images/product.png" alt="" />
    		</div>
    		<div class="item product-item">
    			<img src="images/product.png" alt="" />
    		</div>
    		<div class="item product-item">
    			<img src="images/product.png" alt="" />
    		</div>
    		<div class="item product-item">
    			<img src="images/product.png" alt="" />
    		</div>
    		<div class="item product-item">
    			<img src="images/product.png" alt="" />
    		</div>
    		<div class="item product-item">
    			<img src="images/product.png" alt="" />
    		</div>
    	</div>
    	<div class="menu-list">
    		<h2>新品</h2>
    		<a href="">查看更多</a>
    	</div>
		<div class="product-list">
			<div class="item product-item">
				<div class="item-box">
					<img src="images/product.png" alt="" />
				</div>
				<div class="name line2">长沙天天 粘接型MBT直丝颊面管0.022″7牙位 上一下一 （新老包装随机发货）</div>
				<div class="price">
					<span>$44.44</span>
					<del>$55.55</del>
				</div>
			</div>
			<div class="item product-item">
				<div class="item-box">
					<img src="images/product.png" alt="" />
				</div>
				<div class="name line2">长沙天天 粘接型MBT直丝颊面管0.022″7牙位 上一下一 （新老包装随机发货）</div>
				<div class="price">
					<span>$44.44</span>
					<del>$55.55</del>
				</div>
			</div>
			<div class="item product-item">
				<div class="item-box">
					<img src="images/product.png" alt="" />
				</div>
				<div class="name line2">长沙天天 粘接型MBT直丝颊面管0.022″7牙位 上一下一 （新老包装随机发货）</div>
				<div class="price">
					<span>$44.44</span>
					<del>$55.55</del>
				</div>
			</div>
			<div class="item product-item">
				<div class="item-box">
					<img src="images/product.png" alt="" />
				</div>
				<div class="name line2">长沙天天 粘接型MBT直丝颊面管0.022″7牙位 上一下一 （新老包装随机发货）</div>
				<div class="price">
					<span>$44.44</span>
					<del>$55.55</del>
				</div>
			</div>

		</div>
    </div>
  </div>
  <script src="../../third/bluebird.min.js"></script>
  <script src="../../third/loadash.3.10.1.js"></script>
  <script src="../../js/mui.min.js"></script>
  <script src="../../third/knockout.js"></script>
  <script src="../../third/ko.mapping.js"></script>
  <script src="../../js/mui.pullToRefresh.js"></script>
  <script src="../../js/mui.pullToRefresh.material.js"></script>
  <script src="../../js/utils.enums.js"></script>
  <script src="../../js/utils.config.js"></script>
  <script src="../../js/utils.storages.js"></script>
  <script src="../../js/utils.category.js"></script>
  <script src="../../js/utils.auth.js"></script>
  <script src="../../js/utils.upload.js"></script>
  <script src="../../js/utils.request.js" ></script>
  <script src="../../js/utils.common.js" ></script>
  <script src="js/shop-common.js" ></script>
  <script>
    (function($, doc) {
      $.init({
//      preloadPages:[{
//        id:'KZ_KT_Detail',
//        url: './details.html'
//      }],
        beforeback: function() {
　　   			  plus.navigator.setStatusBarBackground('#765fc3');
          return true;
        }
      });
      $.plusReady(function() {
      	
        plus.navigator.setStatusBarBackground('#8E78D6');
        // 初始化头部
        var HeaderView = function () {
          var vm = this;
          vm.headerText = ko.observable('课堂');
        }
        var headerView = new HeaderView();
        ko.applyBindings(headerView, document.getElementById('header'));
        // tab改变 
        $.each(doc.querySelectorAll('.mui-bar-tab .mui-tab-item'), function( index, el ) {
          el.addEventListener('tap', function( e ) {
            var text = el.querySelector('.mui-tab-label').innerText;
            if (text == '发布') {
              PublishPage();
            } else {
              headerView.headerText( el.querySelector('.mui-tab-label').innerText );
            }
          });
        });
        /*课堂*/
        (function(){
          var category = categorys.get();
          var categoryColor = {
            1: '#BCABF5',
            2: '#F5ABAB',
            3: '#F5C9AB',
            4: '#B2DE8E',
            5: '#97E8C5',
            6: '#ABBBF5',
            7: '#D5A1F0',
            8: '#EBABF5'
          }
          var BaseView = function() {
            var vm = this;
            // 分类
            vm.categorys = ko.observableArray(_.map(category, function(o) {
              o.icon = enums.category[o.id];
              o.color = categoryColor[o.id];
              return o;
            }));
            // 跳转列表
            vm.listFn = function (data) {
            	console.log("data:"+data.title)
              mui.openWindow({
                id:'KZ_KT_CategoryList',
                url: './list.html',
                show: {
                  aniShow: 'pop-in'
                },
                styles: {
                  popGesture: 'hide'
                },
                waiting: {
                  autoShow: false
                },
                extras: {
                  catergoryid: data.id,
                  headtitle: data.title
                }
              });
            }
            // 跳转更多
            vm.moreFn = function (){
              mui.openWindow({
                id:'KZ_KT_MoreList',
                url: './list.html',
                show: {
                  aniShow: 'pop-in'
                },
                styles: {
                  popGesture: 'hide'
                },
                waiting: {
                  autoShow: false
                }
              });
            }
            
            // 跳转详情
            vm.toDetail = function ( data ){
            	console.log(JSON.stringify(data))
              mui.openWindow({
                id:'KZ_KT_Detail',
                url: './details.html',
                show: {
                  aniShow: 'pop-in'
                },
                styles: {
                  popGesture: 'hide'
                },
                waiting: {
                  autoShow: false
                },
                extras: {
                  catergoryid: data.id,
                  headtitle: data.title
                }
              });
            }
            // 最新列表
            vm.newestList = ko.observableArray([]);
          }
          var viewModel = new BaseView();
          ko.applyBindings(viewModel, doc.getElementById('home'));
          VideoSearch({
            page: 1,
            limit: 10,
            ctime: 'desc'
          }).then(function(reslist){
            viewModel.newestList(reslist);
          });
        })();
        /*我的*/
        var wodeWebview = {
          MyVideo: './my-video.html',
          MyBuy: './my-buy.html',
          MyOrder: './my-sell.html',
          MyView: './my-read.html'
        }
        mui('body').on('tap', '#wode a', function(){
          console.log('click');
          var webviewId = this.getAttribute('id');
          console.log(webviewId)
          mui.openWindow({
            id:'KZ_KT_'+ webviewId,
            url: wodeWebview[webviewId],
            show: {
              aniShow: 'pop-in'
            },
            styles: {
              popGesture: 'hide'
            },
            waiting: {
              autoShow: false
            }
          });
        });
      });
    }(mui, document));
  </script>
</body>
</html>