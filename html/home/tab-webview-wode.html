<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>我的</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="../../css/mui.min.css">
		<link href="../../css/style.css" rel="stylesheet" />
		<style>
			p {
				text-align: center;
				margin: 0;
			}
			body,
			.mui-content {
				background-color: #eaeaea;
			}
			.wode-header {
				position: relative;
				background-color: #765fc3;
				text-align: center;
			}
			.wode-header .wh-title p {
				color: #ffffff;
				height: 50px;
				line-height: 50px;
				font-size: 18px;
			}
			.wode-header .msg{
				position: absolute;
				right: 0;
				top: 5px;
				padding: 10px;
			}
			.wode-header .msg img{
				width: 20px;
			}
			.wode-header .user-info {
				padding: 0 10px 40px 10px;
			}
			.wode-header .user-info .img {
				width: 60px;
				height: 60px;
				margin-right: 20px;
				-webkit-border-radius: 50%;
				-moz-border-radius: 50%;
				border-radius: 50%;
				overflow: hidden;
			}
			.wode-header .user-info .img img {
				width: 100%;
			}
			.wode-header .user-info .info {
				padding-top: 4px;
			}
			.wode-header .user-info .info p{
				font-size: 18px;
				color: #ffffff;
				text-align: left;
				margin-top: 5px;
			}

			.count {
				padding: 10px 0;
				background-color: #ffffff;
				color: #303030;
				margin-bottom: 10px;
			}
			.count .flex-1 p:first-child {
				color: #7c7c7c;
			}
			.count p {
				height: 20px;
				line-height: 20px;
			}

			.mui-table-view {
				margin-bottom: 10px;
			}
			.mui-table-view-cell {
				font-size: 14px !important;
				padding: 14px 15px 14px 40px !important;
			}
			.mui-table-view-cell>a:not(.mui-btn) {
			    margin: -14px -15px -14px -40px !important;
			    margin-right: -40px !important;
			}
			.mui-table-view-cell a {
				color: #303030 !important;
			}
			.mui-table-view-cell img {
				position: absolute;
				left: 7px;
				top: 12px;
				width: 25px;
				height: 25px;
			}
			.mui-table-view-cell:after {
				left: 40px !important;
			}
			.btn-padding {
				padding-bottom: 20px;
			}
			.btn-logout {
				display: none;
				width: 100%;
				border: 0;
				color: #303030;
				height: 50px;
				line-height: 50px;
				background-color: #ffffff;
				padding: 0 10px;
				-webkit-border-radius: 0;
				-moz-border-radius: 0;
				border-radius: 0;
			}
			button.btn-logout:enabled,
			button.btn-logout:enabled:active{
				background-color: #ffffff ;
				opacity: 1;
			}
		</style>
	</head>

	<body>
		<div class="mui-content">
			<div class="wode-header">
				<div class="wh-title">
					<p>我的</p>
					<div id="msg" url="../my/my-message.html" login="yes" class="clickItem msg">
						<img src="../../images/tab-wode/msg.png" />
					</div>
				</div>
				<div class="user-info">
					<div id="login" class="flex">
						<div class="img flex flex-row-center">
							<img src="../../images/tab-wode/user_default.png" />
						</div>
						<div class="info flex-1">
							<p id="nickname">游客身份</p>
							<p id="sex">立即登录</p>
						</div>
					</div>
				</div>
			</div>
			<div class="count flex">
				<div id="sc" url="../my/follows.html" login="yes" class="clickItem flex-1">
					<p>收藏</p>
					<p>0</p>
				</div>
				<div id="jf" url="../my/point.html" login="yes" class="clickItem flex-1">
					<p>积分</p>
					<p>0</p>
				</div>
				<div class="flex-1">
					<p>签到</p>
					<p>0</p>
				</div>
			</div>

			<ul class="mui-table-view mui-table-view-chevron">
				<li class="mui-table-view-cell">
					<img src="../../images/tab-wode/yqm.png"/>
					<a class="mui-navigate-right" href="#">
						我的邀请码
					</a>
				</li>
				<li class="mui-table-view-cell">
					<img src="../../images/tab-wode/jhm.png"/>
					<a class="mui-navigate-right" href="#">
						我的激活码
					</a>
				</li>
				<li class="mui-table-view-cell">
					<img src="../../images/tab-wode/wdblx.png"/>
					<a class="mui-navigate-right" href="#">
						我的病例秀
					</a>
				</li>
				<li class="mui-table-view-cell">
					<img src="../../images/tab-wode/bdblx.png"/>
					<a class="mui-navigate-right" href="#">
						本地病例秀
					</a>
				</li>
			</ul>

			<ul class="mui-table-view mui-table-view-chevron">
				<li class="mui-table-view-cell">
					<img src="../../images/tab-wode/tk.png"/>
					<a class="mui-navigate-right" href="#">
						本地图库
					</a>
				</li>
				<li class="mui-table-view-cell">
					<img src="../../images/tab-wode/fk.png"/>
					<a class="mui-navigate-right" href="#">
						意见反馈
					</a>
				</li>
				<li class="mui-table-view-cell">
					<img src="../../images/tab-wode/gy.png"/>
					<a class="mui-navigate-right" href="#">
						关于我们
					</a>
				</li>
			</ul>
			<div class="btn-padding">
				<button id="logout" class="btn-logout">退出登录</button>
			</div>
		</div>
		<script src="../../js/mui.min.js"></script>
		<script src="../../js/tools.js" ></script>
		<script>
			window.addEventListener('refresh', function(e){
			    location.reload();
			});
			function toLogin(fromurl, fromid) {
				var extras = {};
				if (fromurl) {
					extras.fromurl = fromurl;
					extras.fromid = fromid;
				}
				mui.openWindow({
					url: '../login/login.html',
					id: 'login',
					preload: true,
					createNew: true,
					show: {
						aniShow: 'pop-in'
					},
					styles: {
						popGesture: 'hide'
					},
					waiting: {
						autoShow: false
					},
					extras: extras
				});
			}
			(function($, doc) {
				$.init();
				$.plusReady(function() {
					var user = tools.getUser();
					// 判断登录
					var loginItem = doc.getElementById('login');
					var logout = doc.getElementById('logout');
					// 加载登录信息
					if (tools.checkLogin()) {
						if (user.header) {
							$('#login img')[0].src = user.header || '../../images/tab-wode/user_default.png';
							$('#login #nickname')[0].innerText = user.nickname;
							$('#login #sex')[0].innerText = user.sex === 1 ? '男' : '女';
							logout.style.display = 'block';
						}
					}
					var self = plus.webview.currentWebview();
					loginItem.addEventListener('tap', function(event) {
						if (tools.checkLogin()) {
							return;
						}
						toLogin();
					});
					// 退出登录
					logout.addEventListener('tap', function(event) {
						$.confirm('确认退出登录？','退出登录','',function(ok){
							//login/loginOut
							if (ok.index === 1) {
								tools.clearUser();
								location.reload();
							}
						});

					});
					// 其它页面
					var clickItems = $('.clickItem');
					$.each(clickItems, function(index, item) {
						item.addEventListener('tap', function(event) {
							var id = this.getAttribute("id");
							var url = this.getAttribute("url");
							var loginFlag = this.getAttribute('login');
							if (loginFlag === 'yes' && !tools.checkLogin()) {
								toLogin(url,id);
								return;
							}
							$.openWindow({
								url: url,
								id: id,
								preload: true,
								show: {
									aniShow: 'pop-in'
								},
								styles: {
									popGesture: 'hide'
								},
								waiting: {
									autoShow: false
								}
							});
						});
					});
				});
			}(mui, document));
		</script>
	</body>

</html>